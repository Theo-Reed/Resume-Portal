<view class="page">
  <view class="me-card">
    <view class="user-row">
      <block wx:if="{{userInfo}}">
        <image class="avatar" src="{{userInfo.avatarUrl}}" />
      </block>
      <block wx:else>
        <view class="avatar-placeholder"></view>
      </block>

      <view class="user-text">
        <block wx:if="{{!isLoggedIn}}">
          <button
            class="phone-auth-name-btn"
            open-type="getPhoneNumber"
            bindgetrealtimephonenumber="onGetRealtimePhoneNumber"
            bindgetphonenumber="onGetPhoneNumber"
          >
            <text class="nickname nickname-login">{{ui.userNotLoggedIn}}</text>
          </button>
        </block>
        <block wx:else>
          <view class="nickname-container">
            <text class="nickname">{{userInfo ? userInfo.nickName : 'å·²ç™»å½•'}}</text>
            <view class="verification-badge {{isVerified ? 'verified' : 'unverified'}}">
              <text class="verification-text">{{isVerified ? 'å·²è®¤è¯' : 'æœªè®¤è¯'}}</text>
            </view>
          </view>
        </block>
      </view>
    </view>
  </view>

  <view class="me-list">
    <view class="me-item" bindtap="onOpenSaved">
      <text class="me-item-text">{{ui.favoritesEntry}}</text>
    </view>

    <view class="me-item" bindtap="onLanguageTap">
      <text class="me-item-text">{{ui.aiTranslateEntry}}</text>
    </view>

    <view class="me-item">
      <text class="me-item-text">{{ui.generateResumeEntry}}</text>
    </view>

    <view class="me-item">
      <text class="me-item-text">{{ui.publishSkillEntry}}</text>
    </view>

    <view class="me-item" bindtap="onInviteTap">
      <text class="me-item-text">{{ui.inviteCodeEntry}}</text>
    </view>
  </view>

  <!-- Saved jobs bottom sheet (5/6 height, no header) -->
  <block wx:if="{{showSavedSheet}}">
    <view class="favorites-sheet-mask {{savedSheetOpen ? 'favorites-sheet-mask-open' : ''}}" bindtap="closeSavedSheet"></view>
    <view class="favorites-sheet {{savedSheetOpen ? 'favorites-sheet-open' : ''}}">

      <view class="favorites-list-padding">
        <job-list
          class-name="favorites-job-list"
          jobs="{{savedJobs}}"
          loading="{{savedLoading}}"
          scroll-y="{{true}}"
          bind:itemtap="onSavedJobTap"
        />
      </view>

      <view wx:if="{{!savedLoading && savedJobs.length === 0}}" class="empty-favorites">{{ui.emptyFavorites}}</view>
    </view>
  </block>

  <!-- Language bottom sheet (same animation as saved sheet) -->
  <block wx:if="{{showLanguageSheet}}">
    <view class="language-sheet-mask {{languageSheetOpen ? 'language-sheet-mask-open' : ''}}" bindtap="closeLanguageSheet"></view>
    <view class="language-sheet {{languageSheetOpen ? 'language-sheet-open' : ''}}">

      <view class="language-sheet-content">
        <view class="language-item {{currentLanguage === 'Chinese' ? 'language-item-active' : ''}}" data-value="Chinese" bindtap="onLanguageSelect">
          <text class="language-item-text">{{ui.langDefault}}</text>
        </view>
        <view class="language-item {{currentLanguage === 'AIChinese' ? 'language-item-active' : ''}}" data-value="AIChinese" bindtap="onLanguageSelect">
          <text class="language-item-text">{{ui.langAIChinese}}<text wx:if="{{!isAiChineseUnlocked}}"> ğŸ”’</text></text>
        </view>
        <view class="language-item {{currentLanguage === 'AIEnglish' ? 'language-item-active' : ''}}" data-value="AIEnglish" bindtap="onLanguageSelect">
          <text class="language-item-text">{{ui.langAIEnglish}}<text wx:if="{{!isAiChineseUnlocked}}"> ğŸ”’</text></text>
        </view>
      </view>
    </view>
  </block>

  <!-- Invite code bottom sheet -->
  <block wx:if="{{showInviteSheet}}">
    <view class="invite-sheet-mask {{inviteSheetOpen ? 'invite-sheet-mask-open' : ''}}" bindtap="closeInviteSheet"></view>
    <view class="invite-sheet {{inviteSheetOpen ? 'invite-sheet-open' : ''}}">

      <view class="invite-sheet-content">
        <view class="invite-section">
          <text class="invite-section-title">{{ui.myInviteCode}}</text>
          <view class="invite-code-display" bindtap="onCopyInviteCode">
            <text class="invite-code-text">{{myInviteCode}}</text>
            <text class="invite-code-copy">å¤åˆ¶</text>
          </view>
        </view>

        <view class="invite-section">
          <text class="invite-section-title">{{ui.inputInviteCode}}</text>
          <input
            class="invite-code-input"
            type="text"
            placeholder="è¯·è¾“å…¥é‚€è¯·ç "
            value="{{inputInviteCode}}"
            bindinput="onInviteCodeInput"
          />
          <button class="invite-apply-btn" bindtap="onApplyInviteCode">åº”ç”¨</button>
        </view>
      </view>
    </view>
  </block>

  <!-- Job Detail Drawer Component (same as Jobs page) -->
  <job-detail
    show="{{showJobDetail}}"
    job-id="{{selectedJobId}}"
    collection="{{selectedCollection}}"
    bind:close="closeJobDetail"
  />
</view>
