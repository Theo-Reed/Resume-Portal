<view class="spa-container">
  <!-- 1. 全局登录墙与开屏仪式 (Top Level Animation & Auth) -->
  <login-wall visible="{{!isLoggedIn}}" bind:loginSuccess="onLoginSuccess" />

  <ui-feedback id="ui-feedback" />

  <!-- 2. Content Area (Conditional Rendering based on Tab) -->
  <view class="main-content" style="height: calc(100vh - 96rpx - env(safe-area-inset-bottom)); overflow: hidden;">
    <block wx:if="{{bootStatus === 'loading'}}">
      <!-- 基础占位，具体动画由 login-wall 的 splash-phase 承载 -->
      <view style="height: 100vh; background: #fff;"></view>
    </block>

    <block wx:else>
      <!-- Tab 0: Jobs -->
      <view hidden="{{activeTab !== 0}}" class="tab-page">
        <jobs-view active="{{activeTab === 0}}" isLoggedIn="{{isLoggedIn}}" />
      </view>

      <!-- Tab 1: Resume -->
      <view hidden="{{activeTab !== 1}}" class="tab-page">
        <resume-view active="{{activeTab === 1}}" isLoggedIn="{{isLoggedIn}}" />
      </view>

      <!-- Tab 2: Me -->
      <view hidden="{{activeTab !== 2}}" class="tab-page">
         <me-view active="{{activeTab === 2}}" isLoggedIn="{{isLoggedIn}}" />
      </view>
    </block>
  </view>

  <!-- 3. Custom Tab Bar -->
  <view class="custom-tab-bar" style="position: fixed; bottom: 0; left: 0; right: 0; height: 96rpx; background: #fff; display: flex; border-top: 1rpx solid #eee; padding-bottom: env(safe-area-inset-bottom); z-index: 1000;">
    <view class="tab-item" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;" bindtap="onTabChange" data-index="0">
      <view style="width: 48rpx; height: 48rpx; background: {{activeTab === 0 ? '#2E5FE9' : '#ccc'}}; border-radius: 8rpx; margin-bottom: 6rpx;"></view>
      <text style="font-size: 20rpx; color: {{activeTab === 0 ? '#2E5FE9' : '#999'}}; font-weight: {{activeTab === 0 ? 'bold' : 'normal'}};">{{tabLabels.jobs}}</text>
    </view>
    <view class="tab-item" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;" bindtap="onTabChange" data-index="1">
      <view style="width: 48rpx; height: 48rpx; background: {{activeTab === 1 ? '#2E5FE9' : '#ccc'}}; border-radius: 50%; margin-bottom: 6rpx;"></view>
      <text style="font-size: 20rpx; color: {{activeTab === 1 ? '#2E5FE9' : '#999'}}; font-weight: {{activeTab === 1 ? 'bold' : 'normal'}};">{{tabLabels.resume}}</text>
    </view>
    <view class="tab-item" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;" bindtap="onTabChange" data-index="2">
      <view style="width: 48rpx; height: 48rpx; background: {{activeTab === 2 ? '#2E5FE9' : '#ccc'}}; border-radius: 50%; margin-bottom: 6rpx;"></view>
      <text style="font-size: 20rpx; color: {{activeTab === 2 ? '#2E5FE9' : '#999'}}; font-weight: {{activeTab === 2 ? 'bold' : 'normal'}};">{{tabLabels.me}}</text>
    </view>
  </view>
</view>

